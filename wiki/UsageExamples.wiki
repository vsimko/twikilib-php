#summary Usage Examples.

Table of contents:
<wiki:toc max_depth="2" />

= API initialization =
{{{
require_once 'path/to/init-twiki-api.php';

use twikilib\core\Config;
use twikilib\core\FilesystemDB;

$config = new Config('path/to/config.ini');
$db = new FilesystemDB($config);
}}}

Example config.ini file:
{{{
[Config]
  twikiRootDir = /var/www/twiki42
  twikiWebUrl = http://research.ciant.cz/twiki42
  userName = TWikiPhpLibUser
  defaultWeb = Main
}}}

= Handling errors =
== Non-existing topic ==
{{{
use twikilib\core\TopicNotFoundException;
...
try {
  $topic = $db->loadTopicByName('SomeNonExistingTopic');
  // this line will never be reached
  ...
} catch(TopicNotFoundException $e) {
  echo "Sorry, could not find the topic.";
  exit;
}
}}}

== Non-published form field ==
There are two possibilities.
 * Either the default strict mode is used which causes exceptions to be thrown when a non-published field is accessed,
 * or the silent mode is used which returns empty values for such fields

{{{
// handling exceptions in strict mode
use twikilib\nodes\FormFieldNotPublishedException;
...
$topic = $db->loadTopicByName('SomeTopic');
try {
  $secretBankAccount = $topic->getTopicFormNode()->getFormField('BankAccount');
} catch (FormFieldNotPublishedException $e) {
  echo "Sorry, form field not published";
  exit;
}
}}}

{{{
// using silent mode
$config->useStrictPublishedMode = false;
$topic = $db->loadTopicByName('SomeTopic');
$secretBankAccount = $topic->getTopicFormNode()->getFormField('BankAccount');
echo $secretBankAccount; // returns empty string
}}}


= Searching =

Try to keep the amount of queries at minimum. Complex filters should be reimplemented with some sort of caching mechanism if possible. Anyway, the query processing is independent of the TWiki Perl implementation and thus parallel execution will be handled by multiple cores.

== General use of query filters ==
{{{
use twikilib\search\MetaSearch;
...
$search = new MetaSearch($config);
$search->setParentFilter('SomeParentTopic');
$search->setFormNameFilter('UserForm');
$search->setFormFieldFilter('Name', 'Peter.*');
$search->invertLastFilter();
$search->executeQuery();
foreach($search->getResults() as $idx => $topicName) {
  $topic = $db->loadTopicByName($topicName);
  ...
}
}}}